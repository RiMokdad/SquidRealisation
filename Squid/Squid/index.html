<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Editeur de décodeur</title>
    <link rel="icon" href="Content/icons/ico-restore.png"/>
    <link rel="stylesheet" href="Content/css/loading.css" />
    <link rel="stylesheet" href="Content/css/app.css" type="text/css"/>
    <script src="app.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.3/jquery.min.js"></script>

    <!-- 1. Load libraries -->
    <!-- Polyfill(s) for older browsers -->
    <script src="node_modules/core-js/client/shim.min.js"></script>

    <script src="node_modules/zone.js/dist/zone.js"></script>
    <script src="node_modules/reflect-metadata/Reflect.js"></script>
    <script src="node_modules/systemjs/dist/system.src.js"></script>

    <!-- enhanced alert and confirm box-->
    <script src="Content/bootbox/bootbox.min.js"></script>

    <script src="SquidModules/server_requests/server_requests.js"></script>


    <!--Script references. -->
    <!--Reference the SignalR library. -->
    <script src="Scripts/jquery.signalR-2.2.1.min.js"></script>
    <!--Reference the autogenerated SignalR hub script. -->
    <script src="signalr/hubs"></script>

    <!-- 2. Configure SystemJS -->
    <script src="systemjs.config.js"></script>
    <script>
        System.import('app').catch(function (err) { console.error(err); });
        Squid = {};
    </script>
    <script src="SquidModules/server_requests/server_requests.js"></script>
    <script>

        //var TabId=null;
              
        //Squid.Requests.GetDecoderDef(45);

        //SignalR
        var myHubProxy = $.connection.myHub;
        myHubProxy.client.hello = function () {
            alert("hello !");
        };
        $.connection.hub.start()
            .done(function() {
                console.log('Now connected, connection ID=' + $.connection.hub.id);
                $('#hello').click(function () {
                    // Call the Send method on the hub. 
                    myHubProxy.server.hello();
                });
            })
            .fail(function () { console.log('Could not Connect!'); });

        //Tests requêtes
        var decoder = {};
        decoder.Id = null;
        decoder.Name = "a function";
        decoder.Version = "1.0";
        decoder.Category = "category1";
        decoder.Tags = "tag1, tag2";
        decoder.Code = "decode machin bidule";
        decoder.Xml = '<xml xmlns="http://www.w3.org/1999/xhtml"><block type="procedures_defnoreturn" id="Bxhu7`7CiyHNhEJqzxOJ" x="230" y="61"><mutation><arg name="x"></arg><arg name="y"></arg><arg name="z"></arg></mutation><field name="NAME">sfsf</field><field name="version">version</field><field name="category">category</field><field name="tags">t1, t2</field><comment pinned="false" h="80" w="160">Décrire cette fonction…</comment></block></xml>';
        decoder.FrenchSpec = "de la spec";
        //Squid.Requests.SaveDecoder(decoder);
        Squid.Requests.GetDecoderDef(6);
        function Save()
        {
            Squid.Requests.SaveDecoder(decoder);
            decoder.Name = decoder.Name + "1";
        }

    </script>

</head>
<body>
<decoder >
    <div class="loading">
        <div class="sk-circle">
            <div class="sk-circle1 sk-child"></div>
            <div class="sk-circle2 sk-child"></div>
            <div class="sk-circle3 sk-child"></div>
            <div class="sk-circle4 sk-child"></div>
            <div class="sk-circle5 sk-child"></div>
            <div class="sk-circle6 sk-child"></div>
            <div class="sk-circle7 sk-child"></div>
            <div class="sk-circle8 sk-child"></div>
            <div class="sk-circle9 sk-child"></div>
            <div class="sk-circle10 sk-child"></div>
            <div class="sk-circle11 sk-child"></div>
            <div class="sk-circle12 sk-child"></div>
        </div>
    </div>
</decoder>
<!--test buttons-->
<button id="hello">say hello</button>
<button id="savetest" onclick="Save()">save</button>

</body>
</html>
